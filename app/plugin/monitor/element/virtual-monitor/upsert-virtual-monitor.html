
<link rel="import" href="../../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../../bower_components/iron-form/iron-form.html">
<link rel="import" href="../../../../bower_components/paper-card/paper-card.html">

<link rel="import" href="../../../../element/thor-form/thor-form.html">




<dom-module id="monitor-upsert-virtual-monitor">
  <template>
    <style>
      :host {
        --paper-button : {
          background-color: var(--accent-color);
          color: var(--title-color);
          min-width: var(--min-withd-button);
        }
      }

      paper-card  {
        width: 100%;
      }

      .margin-top-20 {
        margin-top: 20px;
      }

      .flex {
        @apply --layout;
      }

      .flex-vertical {
        @apply --layout-vertical;
      }

      .flex-horizontal {
        @apply --layout-horizontal;
      }

      .flex-basis-70 {
        flex-basis:70%;
      }

      .flex-basis-30 {
        flex-basis:30%;
      }

      .flex-end {
        @apply --layout-end-justified;
      }

    </style>
      <div class="flex flex-horizontal">
        <div class="flex-basis-70" style="padding-right:16px;">
          <paper-input id="name" name="name_configuration" label="Name" require></paper-input>
          <template is="dom-repeat" items="{{monitors}}" as="monitor">
            <div class="row">{{monitor.name}}</div>
          </template>
          <paper-button on-tap="saveConfiguration">Save</paper-button>
        </div>
        <div class="flex-basis-30">
          <paper-card id="cardMonitor" heading="Monitor" alt="Monitor">
            <div class="card-content">
              <paper-input name="name" label="Name"></paper-input>
              <paper-input name="height" label="Height"></paper-input>
              <paper-input name="width" label="Width"></paper-input>
              <paper-input name="offsetX" label="Offeset X"></paper-input>
              <paper-input name="offsetY" label="Offeset Y"></paper-input>
            </div>
            <div class="card-actions">
              <paper-button on-tap="addMonitor">Add</paper-button>
            </div>
          </paper-card>
        </div>
      </div>
  </template>
  <script>
      class UpsertVirtualMonitor extends Polymer.Element {

          static get is() { return 'monitor-upsert-virtual-monitor'; }

          static get properties() {
              return {
                  monitors : {
                      type: Array,
                      value: [],
                      notify: true
                  },
                  identifier: {
                      type: String,
                  },
                  height: {
                      type: Number,
                  },
                  width: {
                      type: Number,
                  },
                  top: {
                      type: Number,
                  },
                  left: {
                      type: Number,
                  },
                  zoom: {
                      type: Number,
                      value: 5
                  }
              }
          }

          submit() {
              this.$.upsert.submit();
          }

          addMonitor() {

              let dataArray = this.$.cardMonitor.querySelectorAll('paper-input');
              let data = {};
              for (let i = 0; i < dataArray.length; i++) {
                  data[dataArray[i].name] = dataArray[i].value;
              }

              this.push('monitors', data);
          }

          saveConfiguration() {

              LocalStorageManager.getInstance().get(CONFIGURATION_NAME_SERVICE).save(new Configuration({
                  name:  this.$.name.value,
                  monitors: this.monitors
              }));
          }
      }

      window.customElements.define(UpsertVirtualMonitor.is, UpsertVirtualMonitor);

  </script>
</dom-module>
