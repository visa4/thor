<link rel="import" href="../../../../../bower_components/polymer/polymer.html">

<link rel="import" href="scoreboard-goal-single.html">

<dom-module id="soccer-scoreboard-goal-wc">
    <template>
        <template id="repeatGoal" is="dom-repeat" items="[[goals]]" as="goal">
            <soccer-scoreboar-goal-single-wc player="{{_getPlayer(goal)}}" goal="{{goal}}" on-wrap-remove="_remove" on-wrap-update="_udate" left="{{left}}"></soccer-scoreboar-goal-single-wc>
        </template>
        <div>NUOVI GOAL</div>
    </template>

    <script>
        class ElementSoccerScoreboardGoal extends Polymer.Element {

            static get is() {
                return 'soccer-scoreboard-goal-wc';
            }

            static get properties() {
                return {

                    goals: {
                        type: new PlayerSoccer(),
                        notify: true,
                    },

                    left: {
                        type: Boolean,
                        value: false
                    }
                };
            }

            /**
             * @param {Goal} goal
             * @private
             */
            _getPlayer(goal) {
                return serviceManager.get('SoccerService').getPlayer(this._getTeamName(), goal.playerId)
            }

            /**
             * @param evt
             * @private
             */
            _remove(evt) {
                console.log('ADDD GOAL');
                this.$.repeatCard.render();
            }

            /**
             * @param evt
             * @private
             */
            _udate(evt) {
                console.log('UPDATE GOAL');
                this.$.repeatCard.render();
            }


            /**
             * @return {string}
             * @private
             */
            _getTeamName() {

                let label = '';
                switch (true) {
                    case this.getAttribute('guest') === "":
                        label = SoccerService.GUEST_TEAM;
                        break;
                    case this.getAttribute('home') === "":
                        label = SoccerService.HOME_TEAM;
                        break;
                    default:
                        console.error('No attribute for team name found');

                }

                return label;
            }
        }

        window.customElements.define(ElementSoccerScoreboardGoal.is, ElementSoccerScoreboardGoal);

    </script>
</dom-module>
